## API Report File for "@typeofweb/server"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

/// <reference types="node" />

import type { AnyAsyncFunction } from '@typeofweb/utils';
import type { Callback } from '@typeofweb/utils';
import type { DeepPartial } from '@typeofweb/utils';
import type * as Express_2 from 'express';
import type { Json } from '@typeofweb/utils';
import { MaybeAsync } from '@typeofweb/utils';
import type { Nominal } from '@typeofweb/utils';
import type { Pretty } from '@typeofweb/utils';
import type { SchemaRecord } from '@typeofweb/schema';
import type { SomeSchema } from '@typeofweb/schema';
import type { StoppableServer } from 'stoppable';
import type * as Superagent from 'superagent';
import type { TypeOf } from '@typeofweb/schema';
import type { TypeOfRecord } from '@typeofweb/schema';
import type { URL as URL_2 } from 'url';

// @beta
export interface AppOptions {
    readonly cookies: AppOptionsCookies;
    readonly cors: {
        readonly origin: CorsOrigin | CorsOriginFunction;
        readonly credentials: boolean;
    } | false;
    // (undocumented)
    readonly hostname: string;
    readonly openapi: {
        readonly title: string;
        readonly description: string;
        readonly version: string;
        readonly path?: string;
    } | false;
    // (undocumented)
    readonly port: number;
    // (undocumented)
    readonly router: {
        readonly strictTrailingSlash: boolean;
    };
}

// @beta (undocumented)
export interface AppOptionsCookies extends SetCookieOptions {
    // (undocumented)
    readonly secret: string;
}

// @beta
export type CorsOrigin = true | string | RegExp | string[] | RegExp[];

// @beta (undocumented)
export interface CorsOriginFunction {
    // (undocumented)
    (requestOrigin: string | undefined): MaybeAsync<CorsOrigin>;
}

// @beta
export function createApp(opts: DeepPartial<AppOptions>): TypeOfWebApp;

// @beta (undocumented)
export function createPlugin<PluginName extends string>(name: PluginName, cb: TypeOfWebPlugin<PluginName>['cb']): TypeOfWebPlugin<PluginName>;

// @beta (undocumented)
export interface EventBus {
    // (undocumented)
    readonly emit: <Name extends keyof TypeOfWebEvents>(name: Name, ...arg: undefined extends TypeOfWebEvents[Name] ? readonly [arg?: TypeOfWebEvents[Name]] : readonly [arg: TypeOfWebEvents[Name]]) => void;
    // (undocumented)
    readonly off: <Name extends keyof TypeOfWebEvents>(name: Name, cb: Callback<TypeOfWebEvents[Name]>) => void;
    // (undocumented)
    readonly on: <Name extends keyof TypeOfWebEvents>(name: Name, cb: Callback<TypeOfWebEvents[Name]>) => void;
}

// @beta
export class HttpError extends Error implements StatusError {
    constructor(statusCode: HttpStatusCode, message?: string, body?: unknown);
    // (undocumented)
    readonly body?: unknown;
    // (undocumented)
    readonly statusCode: HttpStatusCode;
}

// @beta (undocumented)
export type HttpMethod = 'get' | 'post' | 'put' | 'patch' | 'delete' | 'head' | 'options';

// @beta
export enum HttpStatusCode {
    Accepted = 202,
    AlreadyReported = 208,
    BadGateway = 502,
    BadRequest = 400,
    Conflict = 409,
    Continue = 100,
    Created = 201,
    EarlyHints = 103,
    ExpectationFailed = 417,
    FailedDependency = 424,
    Forbidden = 403,
    Found = 302,
    GatewayTimeout = 504,
    Gone = 410,
    HTTPVersionNotSupported = 505,
    ImaTeapot = 418,
    IMUsed = 226,
    InsufficientStorage = 507,
    InternalServerError = 500,
    LengthRequired = 411,
    Locked = 423,
    LoopDetected = 508,
    MethodNotAllowed = 405,
    MisdirectedRequest = 421,
    MovedPermanently = 301,
    MultipleChoices = 300,
    MultiStatus = 207,
    NetworkAuthenticationRequired = 511,
    NoContent = 204,
    NonAuthoritativeInformation = 203,
    NotAcceptable = 406,
    NotExtended = 510,
    NotFound = 404,
    NotImplemented = 501,
    NotModified = 304,
    OK = 200,
    PartialContent = 206,
    PayloadTooLarge = 413,
    PaymentRequired = 402,
    PermanentRedirect = 308,
    PreconditionFailed = 412,
    PreconditionRequired = 428,
    Processing = 102,
    ProxyAuthenticationRequired = 407,
    RangeNotSatisfiable = 416,
    RequestHeaderFieldsTooLarge = 431,
    RequestTimeout = 408,
    ResetContent = 205,
    SeeOther = 303,
    ServiceUnavailable = 503,
    SwitchingProtocols = 101,
    SwitchProxy = 306,
    TemporaryRedirect = 307,
    TooEarly = 425,
    TooManyRequests = 429,
    Unauthorized = 401,
    UnavailableForLegalReasons = 451,
    UnprocessableEntity = 422,
    UnsupportedMediaType = 415,
    UpgradeRequired = 426,
    URITooLong = 414,
    UseProxy = 305,
    VariantAlsoNegotiates = 506
}

// @beta (undocumented)
export function isStatusError(err: unknown): err is StatusError;

export { MaybeAsync }

// @beta (undocumented)
export function parseRequestId(id: RequestId): {
    requestReceivedAt: Date;
    requestCounter: number;
};

// @beta (undocumented)
export type ParseRouteParams<Path> = string extends Path ? string : Path extends `${string}/:${infer Param}/${infer Rest}` ? Param | ParseRouteParams<`/${Rest}`> : Path extends `${string}:${infer LastParam}` ? LastParam : never;

// @beta (undocumented)
export type RequestId = Nominal<string, 'RequestId'>;

// @beta (undocumented)
export interface RouteConfig<Path extends string, ParamsKeys extends ParseRouteParams<Path>, Params extends SchemaRecord<ParamsKeys>, Query extends SchemaRecord<string>, Payload extends SomeSchema<Json>, Response extends SomeSchema<Json>> {
    handler(request: TypeOfWebRequest<Path, TypeOfRecord<Params>, TypeOfRecord<Query>, Pretty<TypeOf<Payload>>>, toolkit: TypeOfWebRequestToolkit): MaybeAsync<TypeOf<Response>>;
    // (undocumented)
    readonly method: HttpMethod;
    // (undocumented)
    readonly path: Path;
    // @alpha (undocumented)
    readonly _rawMiddlewares?: ReadonlyArray<Express_2.RequestHandler | Express_2.ErrorRequestHandler>;
    // (undocumented)
    readonly validation: {
        readonly params?: Params;
        readonly query?: Query;
        readonly payload?: Payload;
        readonly response?: Response;
    };
}

// @beta (undocumented)
export type ServerId = Nominal<string, 'ServerId'>;

// @beta (undocumented)
export interface SetCookieOptions {
    // (undocumented)
    readonly domain?: string;
    // (undocumented)
    readonly encrypted?: boolean;
    // (undocumented)
    readonly expires?: Date;
    // (undocumented)
    readonly httpOnly?: boolean;
    // (undocumented)
    readonly maxAge?: number;
    // (undocumented)
    readonly path?: string;
    // (undocumented)
    readonly sameSite?: boolean | 'lax' | 'strict' | 'none';
    // (undocumented)
    readonly secure?: boolean;
}

// @beta
export interface StatusError {
    // (undocumented)
    readonly statusCode: HttpStatusCode;
}

// @beta (undocumented)
export interface TypeOfWebApp {
    // (undocumented)
    readonly events: EventBus;
    // (undocumented)
    inject(injection: {
        readonly method: HttpMethod;
        readonly path: string;
        readonly payload?: string | object | undefined;
        readonly headers?: Record<string, string>;
        readonly cookies?: readonly `${string}=${string}`[];
    }): Promise<Superagent.Response>;
    // (undocumented)
    plugin(plugin: TypeOfWebPlugin<string>): MaybeAsync<TypeOfWebApp>;
    // @alpha
    readonly _rawExpressApp: Express_2.Application;
    // @alpha
    readonly _rawExpressRouter?: Express_2.Router;
    // @alpha
    readonly _rawExpressServer?: StoppableServer;
    // (undocumented)
    route<Path extends string, ParamsKeys extends ParseRouteParams<Path>, Params extends SchemaRecord<ParamsKeys>, Query extends SchemaRecord<string>, Payload extends SomeSchema<Json>, Response extends SomeSchema<Json>>(config: RouteConfig<Path, ParamsKeys, Params, Query, Payload, Response>): TypeOfWebApp;
    // (undocumented)
    start(): Promise<TypeOfWebServer>;
    // (undocumented)
    stop(): Promise<void>;
}

// @beta (undocumented)
export interface TypeOfWebEvents {
    // (undocumented)
    readonly ':afterResponse': TypeOfWebResponse;
    // (undocumented)
    readonly ':error': unknown;
    // (undocumented)
    readonly ':request': TypeOfWebRequest;
    // (undocumented)
    readonly ':server': TypeOfWebServer;
}

// @beta (undocumented)
export interface TypeOfWebPlugin<PluginName extends string> {
    // Warning: (ae-forgotten-export) The symbol "PluginName_" needs to be exported by the entry point index.d.ts
    // Warning: (ae-forgotten-export) The symbol "PluginCallbackReturnValue" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    readonly cb: (app: TypeOfWebApp) => PluginName extends PluginName_ ? MaybeAsync<PluginCallbackReturnValue<PluginName>> : MaybeAsync<undefined | void>;
    // (undocumented)
    readonly name: PluginName;
}

// @beta (undocumented)
export interface TypeOfWebRequest<Path extends string = string, Params extends {} = {}, Query extends {} = {}, Payload = unknown> {
    readonly cookies: Record<string, string>;
    readonly id: RequestId;
    readonly params: Params;
    // (undocumented)
    readonly path: Path;
    readonly payload: Payload;
    // (undocumented)
    readonly plugins: TypeOfWebRequestMeta;
    readonly query: Query;
    // @alpha
    readonly _rawReq: Express_2.Request;
    // @alpha
    readonly _rawRes: Express_2.Response;
    readonly server: TypeOfWebServer;
    readonly timestamp: ReturnType<typeof performance.now>;
}

// @beta (undocumented)
export interface TypeOfWebRequestMeta {
}

// @beta
export interface TypeOfWebRequestToolkit {
    // (undocumented)
    removeCookie(name: string, options?: SetCookieOptions): MaybeAsync<void>;
    // (undocumented)
    setCookie(name: string, value: string, options?: SetCookieOptions): MaybeAsync<void>;
    // (undocumented)
    setHeader(headerName: string, value: string): MaybeAsync<void>;
    // (undocumented)
    setStatus(statusCode: HttpStatusCode): MaybeAsync<void>;
}

// @beta (undocumented)
export interface TypeOfWebResponse {
    readonly payload: Json | null;
    // @alpha
    readonly _rawRes: Express_2.Response;
    readonly request: TypeOfWebRequest;
    readonly statusCode: number;
    readonly timestamp: ReturnType<typeof performance.now>;
}

// @beta (undocumented)
export interface TypeOfWebServer {
    // (undocumented)
    readonly address: URL_2 | null;
    // (undocumented)
    readonly events: EventBus;
    // (undocumented)
    readonly id: ServerId;
    // (undocumented)
    readonly plugins: TypeOfWebServerMeta;
}

// @beta (undocumented)
export interface TypeOfWebServerMeta {
}

// (No @packageDocumentation comment for this package)

```
